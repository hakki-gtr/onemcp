---
description: Complete command reference for the Gentoro OneMCP CLI.
---

# CLI Reference

Complete reference for all Gentoro OneMCP CLI commands, configuration files, and options.

## Command Overview

```bash
onemcp [command] [options]
```

### Quick Reference

| Command | Description |
|---------|-------------|
| `chat` | Start interactive chat mode |
| `status` | Show server and configuration status |
| `stop` | Stop the OneMCP server |
| `logs` | View server logs |
| `doctor` | Check system requirements |
| `update` | Update to latest version |
| `reset` | Reset all configuration |
| `provider list` | Show configured AI providers |
| `provider set` | Configure provider and API key |
| `provider switch` | Switch between providers |
| `handbook init <name>` | Create new handbook |
| `handbook list` | List all handbooks |
| `handbook use [name]` | Set active handbook |
| `handbook current` | Show current handbook |
| `handbook validate [name]` | Validate handbook |
| `service auth` | Configure service authentication |
| `service list` | List configured services |
| `service renew` | Renew service token |
| `completion bash\|zsh\|fish\|powershell` | Generate completion script |

---

## Global Flags

Available for all commands:

- `--config string` - Config file (default: `~/.onemcp/config.yaml`)
- `-h, --help` - Help for any command

---

## Core Commands

### chat

Open interactive chat mode with MCP server.

**Usage:**
```bash
onemcp chat
```

**Behavior:**
- Starts Docker container if not running
- Waits for server to be ready
- Opens interactive chat session
- Displays ACME example prompts (if using acme-analytics)

**In-Chat Commands:**

| Command | Description |
|---------|-------------|
| `help` | Show available in-chat commands |
| `clear` | Clear chat history for current session |
| `switch` | Switch to different handbook |
| `exit`, `quit` | Exit chat mode |

**Example:**
```bash
onemcp chat

# Output:
# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘    Gentoro OneMCP - Chat Mode        â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# Handbook: acme-analytics
# Provider: gemini
#
# You: Show total sales for 2024
# Agent: {...}
```

---

### status

Show OneMCP server and configuration status.

**Usage:**
```bash
onemcp status
```

**Output:**
- Docker container status
- Server health
- Current handbook
- Active AI provider
- Configuration file path

**Example:**
```bash
onemcp status

# Output:
# Docker container: running
# Server health: healthy
# Current handbook: acme-analytics
# Active provider: gemini
# Config: /Users/you/.onemcp/config.yaml
```

---

### stop

Stop the OneMCP server.

**Usage:**
```bash
onemcp stop
```

**Behavior:**
- Gracefully stops Docker container
- Preserves configuration and logs

**Example:**
```bash
onemcp stop

# Output:
# Stopping OneMCP server...
# Container stopped
```

---

### logs

View OneMCP server logs.

**Usage:**
```bash
onemcp logs [flags]
```

**Flags:**
- `-n, --lines int` - Number of lines to show (default: 50)
- `-f, --follow` - Follow log output in real-time

**Examples:**
```bash
# Show last 50 lines
onemcp logs

# Show last 100 lines
onemcp logs -n 100

# Follow logs in real-time
onemcp logs -f

# Follow last 200 lines
onemcp logs -n 200 -f
```

**Use Cases:**
- Debugging connection issues
- Monitoring server performance
- Viewing API call traces
- Troubleshooting errors

---

### doctor

Check system requirements and configuration.

**Usage:**
```bash
onemcp doctor
```

**Checks:**
- Docker installed
- Docker daemon running
- Network connectivity
- Configuration file validity
- Required permissions

**Example:**
```bash
onemcp doctor

# Output:
# âœ“ Docker is installed
# âœ“ Docker daemon is running
# âœ“ Network connectivity OK
# âœ“ Configuration file valid
# âœ“ All requirements met
```

---

### update

Update OneMCP Docker image and display CLI update instructions.

**Usage:**
```bash
onemcp update
```

**Behavior:**
- Detects installation method (Homebrew, Scoop, or Manual)
- Displays appropriate update instructions for the CLI binary
- Pulls latest `admingentoro/gentoro:latest` Docker image

**Example:**
```bash
onemcp update

# Output:
# ðŸ“Œ To update the OneMCP CLI:
#
#   Homebrew:
#     brew upgrade onemcp
#
# ðŸ“¦ Updating OneMCP Docker image...
# latest: Pulling from admin gent oro/gentoro
# Digest: sha256:...
# âœ… Docker image updated successfully!
```

**Installation Detection:**

The command automatically detects how the CLI was installed:
- **Homebrew:** Checks for Cellar path or `brew list onemcp`
- **Scoop:** Checks for Scoop apps path or `scoop list onemcp`
- **Manual:** Falls back if neither package manager is detected

**Note:** This command only updates the Docker image. To update the CLI binary itself, use your package manager or download manually.

---

### version

Show the OneMCP CLI version.

**Usage:**
```bash
onemcp version
# or
onemcp --version
```

**Example:**
```bash
onemcp version

# Output:
# OneMCP CLI v0.0.3
```

**Note:** Version is set at build time via ldflags during the release process.

---

### reset

Reset all OneMCP configuration.

**Usage:**
```bash
onemcp reset
```

**Warning:** This deletes all configuration files. Handbooks are preserved.

**What gets deleted:**
- `~/.onemcp/config.yaml`
- All provider configurations
- All cached data

**What is preserved:**
- Handbooks in `~/onemcp-handbooks/`
- Service authentication files

**Example:**
```bash
onemcp reset

# Output:
# âš ï¸  This will delete all configuration.
# Handbooks will be preserved.
# Continue? (y/N): y
# Configuration reset successfully
```

---

## Provider Management

### provider set

Configure an AI provider and API key.

**Usage:**
```bash
onemcp provider set
```

**Interactive Prompts:**
1. Select provider (OpenAI, Google Gemini, Anthropic)
2. Enter API key
3. Configuration saved

**Supported Providers:**
- **OpenAI** - GPT-4, GPT-3.5-turbo
- **Google Gemini** - Gemini Pro, Gemini Flash
- **Anthropic** - Claude 3 Opus, Sonnet, Haiku

**Example:**
```bash
onemcp provider set

# Interactive:
# ? Select AI provider: Google Gemini
# ? Enter your Gemini API key: **********************
# âœ“ Provider configured successfully
```

---

### provider list

Show all configured AI providers.

**Usage:**
```bash
onemcp provider list
```

**Output:**
- Provider name
- Masked API key (first 6 and last 3 chars)
- Current provider indicator

**Example:**
```bash
onemcp provider list

# Output:
# Configured Providers:
#   âœ“ gemini: AIza************************ (active)
#   âœ“ openai: sk-proj-********************
#   - anthropic: (not configured)
```

---

### provider switch

Switch between configured providers.

**Usage:**
```bash
onemcp provider switch
```

**Interactive Prompts:**
- Shows list of configured providers
- Select provider to activate
- No need to re-enter API keys

**Example:**
```bash
onemcp provider switch

# Interactive:
# ? Select provider to use:
#   > gemini (AIza...abc) [current]
#     openai (sk-proj...xyz)
#     anthropic (sk-ant...123)
```

---

## Handbook Management

### handbook init

Create a new handbook.

**Usage:**
```bash
onemcp handbook init <name>
```

**Arguments:**
- `name` (required) - Name for the new handbook

**Behavior:**
- Creates handbook directory at `~/onemcp-handbooks/<name>`
- Generates template files
- Creates standard directory structure

**Directory Structure Created:**
```
~/onemcp-handbooks/<name>/
â”œâ”€â”€ Agent.yaml              # AI instructions template
â”œâ”€â”€ README.md             # Handbook overview template
â”œâ”€â”€ getting-started.md    # Quick start template
â””â”€â”€ openapi/              # OpenAPI specs directory
    â””â”€â”€ README.md         # Instructions for adding specs
```

**Example:**
```bash
onemcp handbook init customer-api

# Output:
# âœ“ Created handbook: customer-api
# âœ“ Directory: ~/onemcp-handbooks/customer-api
# 
# Next steps:
#   1. Add OpenAPI spec to openapi/ directory
#   2. Customize Agent.yaml with instructions
#   3. Run: onemcp handbook validate customer-api
```

---

### handbook list

List all available handbooks.

**Usage:**
```bash
onemcp handbook list
```

**Output:**
- Handbook name
- Location (built-in or custom)
- Current handbook indicator

**Example:**
```bash
onemcp handbook list

# Output:
# Available Handbooks:
#   - acme-analytics (built-in)
#   * customer-api (current)
#   - analytics-service
#   - payment-api
```

---

### handbook use

Set the active handbook.

**Usage:**
```bash
onemcp handbook use [name]
```

**Arguments:**
- `name` (optional) - Handbook to activate. If omitted, shows interactive selection.

**Behavior:**
- Updates `currenthandbook` in `~/.onemcp/config.yaml`
- Subsequent `onemcp chat` commands use this handbook

**Examples:**
```bash
# Interactive selection
onemcp handbook use

# Direct selection
onemcp handbook use customer-api

# Output:
# âœ“ Switched to handbook: customer-api
```

---

### handbook current

Show the current active handbook.

**Usage:**
```bash
onemcp handbook current
```

**Output:**
- Current handbook name
- Location path

**Example:**
```bash
onemcp handbook current

# Output:
# Current Handbook: acme-analytics
# Location: Built-in
```

---

### handbook validate

Validate handbook structure.

**Usage:**
```bash
onemcp handbook validate [name]
```

**Arguments:**
- `name` (optional) - Handbook to validate. If omitted, validates current handbook.

**Checks:**
- Handbook directory exists
- `openapi/` directory exists
- At least one `.yaml` file in `openapi/`
- Valid YAML syntax

**Example:**
```bash
onemcp handbook validate customer-api

# Output:
# âœ“ Handbook structure valid
# âœ“ OpenAPI directory found
# âœ“ 2 OpenAPI specifications found
# âœ“ No validation errors
```

---

## Service Management

### service auth

Configure authentication for external services.

**Usage:**
```bash
onemcp service auth
```

**Interactive Prompts:**
1. Service name
2. Authentication header (e.g., `Authorization`)
3. Token pattern (e.g., `Bearer {token}`)
4. Token value
5. Expiration date

**Creates:**
`~/onemcp-handbooks/{current-handbook}/service.yaml`

**Example:**
```bash
onemcp service auth

# Interactive:
# ? Service name: my-api
# ? Header name: Authorization
# ? Token pattern: Bearer {token}
# ? Token value: **********************
# ? Expires at (YYYY-MM-DD): 2025-12-31
# âœ“ Service authentication configured
```

**Generated `service.yaml`:**
```yaml
service: my-api
header: Authorization
pattern: Bearer {token}
token: eyJhbGc...
expiresAt: 2025-12-31T23:59:59Z
```

---

### service list

List all configured services.

**Usage:**
```bash
onemcp service list
```

**Output:**
- Service name
- Handbook
- Expiration date
- Status (valid/expired)

**Example:**
```bash
onemcp service list

# Output:
# Configured Services:
#   - customer-api (expires: 2025-12-31) [valid]
#   - payment-api (expires: 2025-06-30) [expired]
```

---

### service renew

Renew service authentication token.

**Usage:**
```bash
onemcp service renew
```

**Interactive Prompts:**
1. Select service to renew
2. New token value
3. New expiration date

**Updates:**
- `token` field in `service.yaml`
- `expiresAt` field in `service.yaml`

**Example:**
```bash
onemcp service renew

# Interactive:
# ? Select service: customer-api
# ? New token value: **********************
# ? Expires at (YYYY-MM-DD): 2026-01-31
# âœ“ Token renewed successfully
```

---

## Shell Completion

### completion

Generate autocompletion scripts for your shell.

**Sub commands:**
- `bash` - Bash completion
- `zsh` - Zsh completion
- `fish` - Fish completion
- `powershell` - PowerShell completion

**Usage:**
```bash
onemcp completion <shell>
```

**Examples:**

**Bash:**
```bash
# Generate completion script
onemcp completion bash > /etc/bash_completion.d/onemcp

# Or add to ~/.bashrc
source <(onemcp completion bash)
```

**Zsh:**
```bash
# Add to ~/.zshrc
source <(onemcp completion zsh)
```

**Fish:**
```bash
onemcp completion fish > ~/.config/fish/completions/onemcp.fish
```

**PowerShell:**
```powershell
onemcp completion powershell | Out-String | Invoke-Expression
```

See [Shell Completion Guide](/docs/guides/shell-completion) for detailed setup.

---

## Configuration

### Global Configuration File

**Location:** `~/.onemcp/config.yaml`

**Structure:**
```yaml
provider: gemini                  # Active AI provider
apikeys:
  gemini: YOUR_GEMINI_KEY
  openai: YOUR_OPENAI_KEY
  anthropic: YOUR_ANTHROPIC_KEY
currenthandbook: acme-analytics   # Active handbook
defaultport: 8080                 # Server port
handbookdir: /path/to/handbooks   # Handbooks directory
chattimeout: 240                  # Chat timeout (seconds)
```

**Fields:**
- **provider** (string) - Active AI provider (`gemini`, `openai`, `anthropic`)
- **apikeys** (object) - API keys for each provider
- **currenthandbook** (string) - Name of active handbook
- **defaultport** (integer) - Server port (default: 8080)
- **handbookdir** (string) - Path to handbooks directory
- **chattimeout** (integer) - Chat timeout in seconds (default: 240)

**Manual Editing:**
```bash
nano ~/.onemcp/config.yaml
```

---

### Handbook Structure

**Location:** `~/onemcp-handbooks/{handbook-name}/`

**Structure:**
```
handbook/
â”œâ”€â”€ Agent.yaml              # AI instructions
â”œâ”€â”€ README.md             # Handbook overview
â”œâ”€â”€ getting-started.md    # Quick start guide
â”œâ”€â”€ openapi/              # OpenAPI specs (REQUIRED)
â”‚   â””â”€â”€ api.yaml
â”œâ”€â”€ docs/                 # Additional docs (optional)
â””â”€â”€ data/                 # Data files (optional, not used by server)
```

**Required:**
- `openapi/` directory with at least one `.yaml` file

**Recommended:**
- `Agent.yaml` - Instructions for the AI agent

**Optional:**
- `README.md`, `getting-started.md` - Documentation
- `docs/` - Additional markdown files
- `data/` - Data files (not processed by server)

---

### Service Authentication File

**Location:** `~/onemcp-handbooks/{handbook-name}/service.yaml`

**Structure:**
```yaml
service: my-api                    # Service identifier
header: Authorization              # HTTP header name
pattern: Bearer {token}            # Token pattern
token: eyJhbGc...                  # Token value
expiresAt: 2025-12-31T23:59:59Z   # Expiration timestamp
```

**Fields:**
- **service** - Unique service identifier
- **header** - HTTP header for authentication
- **pattern** - Token pattern with `{token}` placeholder
- **token** - Actual token value
- **expiresAt** - ISO 8601 timestamp for expiration

**Common Patterns:**
```yaml
# Bearer token
header: Authorization
pattern: Bearer {token}

# API key
header: X-API-Key
pattern: {token}

# Custom header
header: X-Custom-Auth
pattern: Token {token}
```

---

## Environment Variables

### Runtime Configuration

- `ONEMCP_CONFIG` - Override config file path
- `ONEMCP_PORT` - Override server port
- `ONEMCP_HANDBOOK_DIR` - Override handbooks directory

**Examples:**
```bash
# Use custom config
ONEMCP_CONFIG=/custom/config.yaml onemcp chat

# Use custom port
ONEMCP_PORT=9090 onemcp chat

# Use custom handbook directory
ONEMCP_HANDBOOK_DIR=/my/handbooks onemcp handbook list
```

---

## Best Practices

### Configuration Management

- **Version control**: Keep handbooks in Git, exclude `service.yaml`
- **Secrets management**: Never commit API keys or tokens to version control
- **Environment separation**: Use separate handbooks for dev/staging/prod

### Handbook Organization

- **One handbook per service**: Keep each API separate
- **Descriptive names**: Use clear names like `customer-api`, not `api1`
- **Documentation**: Include comprehensive docs
- **Validation**: Run `validate` after changes

### Service Authentication

- **Token rotation**: Regularly renew tokens using `service renew`
- **Expiration dates**: Set realistic expiration dates
- **Least privilege**: Use tokens with minimal permissions
- **Secure storage**: Protect configuration files

### Troubleshooting

- **Check logs first**: `onemcp logs` to diagnose issues
- **Verify health**: `onemcp status` to check service health
- **Run doctor**: `onemcp doctor` to verify requirements
- **Clean restart**: `onemcp stop` then `onemcp chat`

---

## See Also

- [CLI Guide](/docs/guides/cli-guide) - Comprehensive usage guide
- [CLI Installation](/docs/installation/cli) - Installation methods
- [Shell Completion](/docs/guides/shell-completion) - Tab completion setup
- [Development CLI](/docs/guides/dev-cli) - Local development tools
